{"debug_id":"141feb98-505c-5418-9457-adc848a3e282","file":"lyrics.js","mappings":"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","names":[],"sourceRoot":"/","sources":["src/commands/music/lyrics.ts"],"sourcesContent":["import { Command, KATClient as Client, Commander, MusicPrompts } from '@structures/index.js';\nimport { SlashCommandBuilder, ChatInputCommandInteraction, EmbedBuilder, Message } from 'discord.js';\nimport { ActionEmbed } from '@utils/embeds/index.js';\n\nimport GeniusLyrics from 'genius-lyrics';\nconst genius = new GeniusLyrics.Client();\n\nexport class LyricsCommand extends Command {\n    constructor(client: Client, commander: Commander) {\n        super(client, commander, {\n            name: 'lyrics',\n            module: 'Music',\n            legacy: true,\n            description: {\n                content: 'View the current tracks lyrics or search for one.',\n                format: '<?title/url>',\n            },\n        });\n    }\n\n    data() {\n        return new SlashCommandBuilder()\n            .setName(this.name)\n            .setDescription(this.description?.content!)\n            .setDMPermission(false)\n            .addStringOption((option) => option.setName('query').setDescription('The name or URL of the track to search for.'));\n    }\n\n    async execute(int: ChatInputCommandInteraction<'cached'> | Message<true>) {\n        const author = this.commander.getAuthor(int);\n        let query = this.commander.getArgs(int).join(' ');\n\n        const subscription = this.client.dispatcher.getSubscription(int.guild);\n        if (!query && subscription && subscription.active) query = subscription.active.title;\n        if (!query) return this.commander.reply(int, { embeds: [new ActionEmbed('fail').setText(MusicPrompts.NotPlaying)] });\n\n        this.applyCooldown(author);\n\n        const noResults = new ActionEmbed('fail').setText(MusicPrompts.NoResults);\n\n        try {\n            const search = await genius.songs.search(query);\n\n            let lyrics = search[0] ? await search[0].lyrics() : null;\n            if (!lyrics) return this.commander.reply(int, { embeds: [noResults] });\n            if (lyrics.length > 4000) lyrics = lyrics.substring(0, 4000) + '\\n...';\n\n            const success = new EmbedBuilder();\n            success.setDescription(\n                `**Track: ${search[0].title} - ${search[0].artist.name}**\\n\\n\\`\\`\\`${lyrics}\\`\\`\\`\\n**Lyrics provided by [Genius](https://genius.com)**`\n            );\n\n            this.commander.reply(int, { embeds: [success] });\n        } catch (err) {\n            this.client.logger.error(err);\n            this.commander.reply(int, { embeds: [noResults] });\n        }\n    }\n}\n"],"version":3}