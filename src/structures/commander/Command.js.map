{"debug_id":"4116dc34-bf87-5106-a478-56823d54f058","file":"Command.js","mappings":";AAEA,OAAO,EAAE,MAAM,EAAE,MAAM,aAAa,CAAC;AACrC,OAAO,EAAE,mBAAmB,EAAqC,UAAU,EAAa,MAAM,YAAY,CAAC;AAmB3G,MAAM,OAAgB,OAAO;IAoBN;IAAuB;IAnBnC,IAAI,CAAS;IACb,MAAM,CAAS;IACtB,gDAAgD;IACzC,OAAO,CAAY;IACnB,WAAW,CAGhB;IACK,QAAQ,CAAU;IAClB,SAAS,CAAW;IAC3B,wCAAwC;IACjC,OAAO,CAAW;IAClB,KAAK,CAAe;IACpB,MAAM,CAAW;IACjB,QAAQ,CAAW;IACnB,SAAS,CAAgC;IAIhD,YAAmB,MAAc,EAAS,SAAoB,EAAE,OAAuB;QAApE,WAAM,GAAN,MAAM,CAAQ;QAAS,cAAS,GAAT,SAAS,CAAW;QAC1D,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;QACzB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;QAC/B,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;QACvC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;QACjC,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;QACnC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;QAC/B,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;QAC3B,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;QAC7B,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;QACjC,IAAI,CAAC,SAAS,GAAG,IAAI,UAAU,EAAqB,CAAC;QAErD,IAAI,OAAO,CAAC,MAAM;YAAE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,SAAS,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC;IACjJ,CAAC;IAED,IAAI;QACA,OAAO,IAAI,mBAAmB,EAAE;aAC3B,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC;aAClB,cAAc,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,IAAI,EAAE,CAAC;aAC/C,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACvC,CAAC;IAED,aAAa,CAAC,IAAU;QACpB,IAAI,CAAC,IAAI,CAAC,QAAQ;YAAE,OAAO;QAE3B,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QACvB,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QAEtC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC;YAAE,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,GAAG,QAAQ,CAAC,CAAC;QAE/E,UAAU,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;IAChE,CAAC;IAED,KAAK,CAAC,MAAc;QAChB,OAAO,GAAG,MAAM,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC,CAAC,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IACnG,CAAC;CACJ","names":[],"sourceRoot":"/","sources":["src/structures/commander/Command.ts"],"sourcesContent":["import { KATClient as Client } from '../Client.js';\nimport { Commander } from './Commander.js';\nimport { Module } from './Module.js';\nimport { SlashCommandBuilder, ChatInputCommandInteraction, User, Collection, Snowflake } from 'discord.js';\n\ninterface CommandOptions {\n    name: string;\n    module: string;\n    aliases?: string[];\n    legacy?: boolean;\n    description?: {\n        content?: string;\n        format?: string;\n    };\n    cooldown?: number;\n    ephemeral?: boolean;\n    allowDM?: boolean;\n    users?: Snowflake[];\n    hidden?: boolean;\n    disabled?: boolean;\n}\n\nexport abstract class Command {\n    public name: string;\n    public module: Module;\n    // Remove this when implementing slash commands.\n    public aliases?: string[];\n    public description?: {\n        content?: string;\n        format?: string;\n    };\n    public cooldown?: number;\n    public ephemeral?: boolean;\n    // Change the name of this, pretty shit.\n    public allowDM?: boolean;\n    public users?: Snowflake[];\n    public hidden?: boolean;\n    public disabled?: boolean;\n    public cooldowns: Collection<Snowflake, number>;\n\n    abstract execute(interaction: ChatInputCommandInteraction): any;\n\n    constructor(public client: Client, public commander: Commander, options: CommandOptions) {\n        this.name = options.name;\n        this.aliases = options.aliases;\n        this.description = options.description;\n        this.cooldown = options.cooldown;\n        this.ephemeral = options.ephemeral;\n        this.allowDM = options.allowDM;\n        this.users = options.users;\n        this.hidden = options.hidden;\n        this.disabled = options.disabled;\n        this.cooldowns = new Collection<Snowflake, number>();\n\n        if (options.module) this.module = this.commander.modules.get(options.module) ?? new Module(this.client, commander, { name: options.module });\n    }\n\n    data(): SlashCommandBuilder | Omit<SlashCommandBuilder, 'addSubcommand' | 'addSubcommandGroup'> {\n        return new SlashCommandBuilder()\n            .setName(this.name)\n            .setDescription(this.description?.content ?? '')\n            .setDMPermission(this.allowDM);\n    }\n\n    applyCooldown(user: User): void {\n        if (!this.cooldown) return;\n\n        const now = Date.now();\n        const cooldown = this.cooldown * 1000;\n\n        if (!this.cooldowns.has(user.id)) this.cooldowns?.set(user.id, now + cooldown);\n\n        setTimeout(() => this.cooldowns?.delete(user.id), cooldown);\n    }\n\n    usage(prefix: string) {\n        return `${prefix}${this.name}${this.description?.format ? ' ' + this.description.format : ''}`;\n    }\n}\n"],"version":3}